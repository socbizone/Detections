rule Zerologon_exploit
{
    meta:
        vulnerability = "CVE-2020-1472"
        description = "Memory detection of Zerologon exploits"
        reference = "<https://www.secura.com/blog/zero-logon>"
        reference = "<https://www.cynet.com/zerologon>"
 
    strings:
        $pattern = {00 ?? ?? (0? | 10 | 11) 00 00 00 00 00 00 00 (0? | 10 | 11) 00 00 00 (4? | 5? | 6? | 7? | 2D) 00 [1-27] 00 (24 | 00) 00 00 00 ( 00 00 | 06 00 | 06 00 00 00) (0? | 10) 00 00 00 00 00 00 00 (0? | 10) 00 00 00  (4? | 5? | 6? | 7? | 2D) 00 [1-27] 00 00 00 [8] FF FF 2F 21}
 
    condition:
        $pattern
}